<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APAC Finance Leadership - Ask Me Anything (AMA)</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #ffffff;
            color: #333333;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        .card {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
            border: 1px solid #eaeaea;
        }
        .btn-primary {
            background-color: #e31837;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            border: none;
        }
        .btn-primary:hover {
            background-color: #c01530;
        }
        .btn-secondary {
            background-color: #f0f0f0;
            color: #333333;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            border: none;
        }
        .btn-secondary:hover {
            background-color: #e0e0e0;
        }
        .btn-danger {
            background-color: #b91c1c;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            border: none;
        }
        .btn-danger:hover {
            background-color: #991b1b;
        }
        .btn-success {
            background-color: #1b7e1e;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            border: none;
        }
        .btn-success:hover {
            background-color: #166118;
        }
        .form-input, .form-select, .form-textarea {
            background-color: #f9f9f9;
            color: #333333;
            border: 1px solid #dddddd;
            border-radius: 4px;
            padding: 8px 12px;
            width: 100%;
            margin-bottom: 16px;
        }
        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #333333;
        }
        .badge {
            background-color: #f0f0f0;
            color: #333333;
            border-radius: 20px;
            padding: 4px 10px;
            font-size: 0.8rem;
            display: inline-block;
            margin-right: 6px;
        }
        .badge-benefits { background-color: #4CAF50; color: white; }
        .badge-compensation { background-color: #2196F3; color: white; }
        .badge-strategy { background-color: #9C27B0; color: white; }
        .badge-others { background-color: #FF9800; color: white; }
        .upvote-btn {
            background-color: transparent;
            border: none;
            color: #555555;
            cursor: pointer;
            transition: color 0.3s;
        }
        .upvote-btn:hover {
            color: #e31837;
        }
        .upvoted {
            color: #e31837;
        }
        .admin-controls {
            display: none;
        }
        .logo-container {
            max-width: 220px; /* Enlarged logo container */
            margin-right: 20px;
        }
        .tab-active {
            border-bottom: 3px solid #e31837;
            font-weight: 600;
            color: #e31837;
        }
        .question-card {
            transition: transform 0.3s;
        }
        .question-card:hover {
            transform: translateY(-3px);
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        .modal-content {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            color: #333333;
        }
        .ch-red {
            color: #e31837;
        }
        .bg-ch-red {
            background-color: #e31837;
        }
        .timestamp {
            font-size: 0.8rem;
            color: #777;
            margin-bottom: 4px;
        }
        .update-card {
            border-left: 3px solid #e31837;
            padding-left: 16px;
            margin-bottom: 24px;
        }
        .update-content {
            white-space: pre-line;
        }
        .info-box {
            background-color: #e6f2ff;
            border-left: 4px solid #4299e1;
            padding: 12px 16px;
            margin-bottom: 16px;
            color: #333333;
        }
        .warning-box {
            background-color: #fff8e6;
            border-left: 4px solid #ed8936;
            padding: 12px 16px;
            margin-bottom: 16px;
            color: #333333;
        }
        .success-box {
            background-color: #e6ffed;
            border-left: 4px solid #48bb78;
            padding: 12px 16px;
            margin-bottom: 16px;
            color: #333333;
        }
        .error-box {
            background-color: #ffebee;
            border-left: 4px solid #f56565;
            padding: 12px 16px;
            margin-bottom: 16px;
            color: #333333;
        }
        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background-color: #e31837;
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 8px;
        }
        code {
            background-color: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9em;
            color: #333333;
        }
        .email-preview {
            background-color: #f5f5f5;
            color: #333;
            border-radius: 4px;
            padding: 12px;
            font-family: Arial, sans-serif;
            margin-bottom: 16px;
        }
        .email-preview-header {
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .hidden-form {
            display: none;
        }
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(227, 24, 55, 0.3);
            border-radius: 50%;
            border-top-color: #e31837;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        /* Dark accents for key UI elements */
        .navbar {
            background-color: #333333;
            color: white;
        }
        .navbar a {
            color: white;
        }
        .accordion-header {
            background-color: #f0f0f0;
            color: #333333;
        }
        .accordion-content {
            background-color: #ffffff;
            color: #333333;
        }
        /* For admin panel sections */
        .admin-panel-card {
            background-color: #f9f9f9;
            border: 1px solid #eaeaea;
        }
        /* New styles for refresh and synchronization features */
        .refresh-bar {
            display: flex;
            align-items: center;
            background-color: #f9f9f9;
            border-radius: 4px;
            padding: 6px 12px;
            margin-bottom: 16px;
        }
        .refresh-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background-color: #4CAF50;
            border-radius: 50%;
            margin-right: 8px;
        }
        .refresh-indicator.checking {
            background-color: #2196F3;
            animation: pulse 1.5s infinite;
        }
        .refresh-indicator.new-content {
            background-color: #e31837;
            animation: pulse 1.5s infinite;
        }
        .refresh-status {
            flex-grow: 1;
            color: #555;
            font-size: 0.9rem;
        }
        .refresh-button {
            background-color: #e31837;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        .refresh-button:hover {
            background-color: #c01530;
        }
        .refresh-button i {
            margin-right: 4px;
        }
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        .screenshot {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 4px;
            max-width: 100%;
            height: auto;
            margin: 10px 0;
        }
        .hosting-guide {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        .hosting-guide.expanded {
            max-height: 2000px;
        }
        .auto-refresh-toggle {
            display: flex;
            align-items: center;
            margin-left: 10px;
            font-size: 0.9rem;
        }
        .auto-refresh-toggle input {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container py-6">
        <!-- Header with Logo -->
        <div class="flex flex-col md:flex-row items-center mb-8">
            <div class="logo-container">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3f/C._H._Robinson_logo.svg/1280px-C._H._Robinson_logo.svg.png" alt="CH Robinson Logo" class="w-full">
            </div>
            <div class="text-center md:text-left mt-4 md:mt-0">
                <h1 class="text-3xl font-bold text-gray-800">APAC Finance Leadership - Ask Me Anything (AMA)</h1>
            </div>
            <div class="ml-auto mt-4 md:mt-0">
                <button id="adminLoginBtn" class="btn-secondary"><i class="fas fa-lock mr-2"></i>Admin Login</button>
                <button id="adminLogoutBtn" class="btn-secondary" style="display: none;"><i class="fas fa-sign-out-alt mr-2"></i>Logout</button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="flex border-b border-gray-300 mb-6 overflow-x-auto">
            <button id="tabAllQuestions" class="px-4 py-2 text-lg tab-active">All Questions</button>
            <button id="tabLeadershipUpdates" class="px-4 py-2 text-lg">Leadership Updates</button>
            <button id="tabSubmitQuestion" class="px-4 py-2 text-lg">Submit a Question</button>
            <div id="adminTabs" style="display: none;">
                <button id="tabAdminPanel" class="px-4 py-2 text-lg">Admin Panel</button>
            </div>
        </div>

        <!-- Refresh Bar - New Feature -->
        <div id="refreshBar" class="refresh-bar" style="display: none;">
            <span id="refreshIndicator" class="refresh-indicator"></span>
            <span id="refreshStatus" class="refresh-status">Content is up to date</span>
            <div class="auto-refresh-toggle">
                <input type="checkbox" id="autoRefreshToggle" checked>
                <label for="autoRefreshToggle">Auto-refresh</label>
            </div>
            <button id="manualRefreshBtn" class="refresh-button">
                <i class="fas fa-sync-alt"></i> Refresh
            </button>
        </div>

        <!-- Search and Filter Bar -->
        <div id="searchFilterBar" class="mb-6 flex flex-col md:flex-row items-center">
            <div class="w-full md:w-1/2 mb-4 md:mb-0">
                <input type="text" id="searchInput" placeholder="Search questions..." class="form-input">
            </div>
            <div class="w-full md:w-1/2 md:pl-4 flex">
                <div class="w-full">
                    <select id="topicFilter" class="form-select">
                        <option value="all">All Topics</option>
                        <option value="benefits">Employee Benefits</option>
                        <option value="compensation">Compensation</option>
                        <option value="strategy">Strategy & Direction</option>
                        <option value="others">Others</option>
                    </select>
                </div>
                <div class="ml-2">
                    <select id="sortFilter" class="form-select">
                        <option value="latest">Latest</option>
                        <option value="popular">Most Upvoted</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Questions List Container -->
        <div id="questionsContainer" class="mb-8">
            <!-- Questions will be populated here by JavaScript -->
            <div class="text-center py-16">
                <i class="fas fa-spinner fa-spin text-4xl mb-4 ch-red"></i>
                <p>Loading questions...</p>
            </div>
        </div>

        <!-- Leadership Updates Container -->
        <div id="leadershipUpdatesContainer" class="mb-8" style="display: none;">
            <div class="card p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">Leadership Updates</h2>
                    <button id="addUpdateBtn" class="btn-primary admin-controls" style="display: none;">
                        <i class="fas fa-plus mr-2"></i>Add Update
                    </button>
                </div>
                
                <div id="updatesContent" class="space-y-6">
                    <!-- Updates will be populated here by JavaScript -->
                    <div class="text-center py-8">
                        <i class="fas fa-info-circle text-4xl mb-4 text-gray-500"></i>
                        <p class="text-gray-600">No updates available yet.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Submit Question Form - Initially Hidden -->
        <div id="submitQuestionForm" class="card p-6" style="display: none;">
            <h2 class="text-2xl font-bold mb-4">Submit Your Question</h2>
            <form id="questionForm">
                <div class="mb-4">
                    <label class="form-label" for="questionTitle">Question Title</label>
                    <input type="text" id="questionTitle" class="form-input" placeholder="Brief title of your question" required>
                </div>
                
                <div class="mb-4">
                    <label class="form-label" for="questionContent">Question Details</label>
                    <textarea id="questionContent" class="form-textarea" rows="4" placeholder="Provide details about your question..." required></textarea>
                </div>
                
                <div class="mb-4">
                    <label class="form-label" for="questionTopic">Topic</label>
                    <select id="questionTopic" class="form-select" required>
                        <option value="">-- Select a Topic --</option>
                        <option value="benefits">Employee Benefits</option>
                        <option value="compensation">Compensation</option>
                        <option value="strategy">Strategy & Direction</option>
                        <option value="others">Others</option>
                    </select>
                </div>
                
                <div class="mb-4">
                    <label class="form-label" for="submitterName">Your Name (Optional)</label>
                    <input type="text" id="submitterName" class="form-input" placeholder="Leave blank to remain anonymous">
                    <p class="text-sm text-gray-600 mt-1">If left blank, your question will be posted anonymously.</p>
                </div>
                
                <div class="mb-4">
                    <label class="form-label" for="submitterEmail">Your Email (Optional)</label>
                    <input type="email" id="submitterEmail" class="form-input" placeholder="For notification when answered (not displayed publicly)">
                    <p class="text-sm text-gray-600 mt-1">We'll notify you when your question is answered. Your email will not be shared.</p>
                </div>
                
                <div class="flex justify-end">
                    <button type="submit" id="submitQuestionBtn" class="btn-primary">
                        <i class="fas fa-paper-plane mr-2"></i>Submit Question
                    </button>
                </div>
            </form>
        </div>

        <!-- Admin Panel - Initially Hidden -->
        <div id="adminPanel" class="card p-6" style="display: none;">
            <h2 class="text-2xl font-bold mb-4">Admin Panel</h2>
            
            <div class="mb-6">
                <h3 class="text-xl font-semibold mb-2">Pending Questions</h3>
                <div id="pendingQuestionsContainer" class="space-y-4">
                    <!-- Pending questions will be populated here -->
                    <p class="text-gray-600">No pending questions.</p>
                </div>
            </div>
            
            <div class="mb-6">
                <h3 class="text-xl font-semibold mb-2">Email Notification Settings</h3>
                <div class="card p-4 admin-panel-card mb-4">
                    <div class="success-box mb-4">
                        <h4 class="font-bold mb-2"><i class="fas fa-check-circle mr-2"></i>Email Notifications Configured</h4>
                        <p>Email notifications are set up to notify:</p>
                        <ul class="list-disc ml-6 mt-2">
                            <li><strong>Admin (james.neo@chrobinson.com)</strong> when new questions are submitted</li>
                            <li><strong>Employees</strong> when their questions receive answers (if they provided an email)</li>
                        </ul>
                    </div>
                    
                    <p class="mb-2">The system uses a built-in form submission service that works on any hosting platform.</p>
                    
                    <div class="flex mb-4">
                        <button id="testEmailBtn" class="btn-primary mr-2">
                            <i class="fas fa-paper-plane mr-1"></i> Test Email System
                        </button>
                        <button id="viewEmailPreviewBtn" class="btn-secondary">
                            <i class="fas fa-eye mr-1"></i> View Email Preview
                        </button>
                    </div>
                    
                    <div id="emailStatusIndicator" class="info-box">
                        <p><i class="fas fa-info-circle mr-2"></i>Email system status: <span id="emailStatus">Ready</span></p>
                    </div>
                </div>
                
                <div class="card p-4 admin-panel-card">
                    <h4 class="font-bold mb-3">Email Troubleshooting</h4>
                    
                    <div class="accordion">
                        <div class="accordion-item mb-3">
                            <div class="accordion-header cursor-pointer flex items-center justify-between p-3 rounded">
                                <span class="font-semibold">If Email Notifications Aren't Working</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content hidden p-3 rounded-b">
                                <p class="mb-3">If the automatic email system isn't working, here are some troubleshooting steps:</p>
                                
                                <div class="mb-3">
                                    <span class="step-number">1</span>
                                    <span>Test connectivity by clicking the "Test Email System" button above</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">2</span>
                                    <span>Check if your network blocks outgoing form submissions</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">3</span>
                                    <span>Verify the admin email is correct (currently: james.neo@chrobinson.com)</span>
                                </div>
                                
                                <div class="warning-box mt-4">
                                    <h5 class="font-bold mb-2">Limitations</h5>
                                    <p>The email system has a limit of around 50 emails per day with the free service we're using.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="accordion-item mb-3">
                            <div class="accordion-header cursor-pointer flex items-center justify-between p-3 rounded">
                                <span class="font-semibold">How The Email System Works</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content hidden p-3 rounded-b">
                                <p class="mb-3">This system uses a method that works without requiring account setup or creating draft emails:</p>
                                
                                <div class="mb-3">
                                    <span class="step-number">1</span>
                                    <span>When a form is submitted, data is sent to a specialized form processing service</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">2</span>
                                    <span>The service processes the request and sends an email to the designated address</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">3</span>
                                    <span>No client-side email applications are opened during this process</span>
                                </div>
                                
                                <div class="info-box mt-4">
                                    <h5 class="font-bold mb-2">Technical Details</h5>
                                    <p>The system uses AJAX requests to process form submissions and delivers emails without page redirects or popups.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="accordion-item mb-3">
                            <div class="accordion-header cursor-pointer flex items-center justify-between p-3 rounded">
                                <span class="font-semibold">Manual Email Alternative</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content hidden p-3 rounded-b">
                                <p class="mb-3">If all automatic methods fail, you can use the traditional email client approach:</p>
                                
                                <div class="mb-3">
                                    <a href="#" id="manualAdminEmailLink" class="text-blue-600 underline">
                                        <i class="fas fa-envelope mr-1"></i> Send notification to admin manually
                                    </a>
                                </div>
                                
                                <div class="mb-3">
                                    <a href="#" id="manualEmployeeEmailLink" class="text-blue-600 underline">
                                        <i class="fas fa-envelope mr-1"></i> Send notification to employee manually
                                    </a>
                                </div>
                                
                                <p class="text-sm text-gray-600 mt-3">Note: These links will open your default email application.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Hosting Guide Section - New Feature -->
            <div class="mb-6">
                <h3 class="text-xl font-semibold mb-2">Hosting Instructions</h3>
                <div class="card p-4 admin-panel-card">
                    <p class="mb-4">Here are step-by-step instructions for hosting this AMA portal for free:</p>
                    
                    <div class="accordion">
                        <!-- GitHub Pages Option -->
                        <div class="accordion-item mb-3">
                            <div class="accordion-header cursor-pointer flex items-center justify-between p-3 rounded">
                                <span class="font-semibold">Option 1: GitHub Pages (Recommended)</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content hidden p-3 rounded-b">
                                <p class="mb-3">GitHub Pages is a free hosting service that's reliable and simple to set up:</p>
                                
                                <div class="mb-3">
                                    <span class="step-number">1</span>
                                    <span>Create a GitHub account at <a href="https://github.com" target="_blank" class="text-blue-600 underline">github.com</a> if you don't have one</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">2</span>
                                    <span>Click the + icon in the top right corner and select "New repository"</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">3</span>
                                    <span>Name your repository (e.g., "apac-finance-ama") and make it public</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">4</span>
                                    <span>Click "Create repository"</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">5</span>
                                    <span>In your new repository, click "Add file" > "Upload files"</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">6</span>
                                    <span>Save this HTML file to your computer and rename it to "index.html"</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">7</span>
                                    <span>Drag and drop the "index.html" file to the GitHub upload area</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">8</span>
                                    <span>Click "Commit changes"</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">9</span>
                                    <span>Go to the "Settings" tab of your repository</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">10</span>
                                    <span>Scroll down to "GitHub Pages" section</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">11</span>
                                    <span>Under "Source", select "main" branch and click "Save"</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">12</span>
                                    <span>Wait a minute, then refresh the page. You'll see a URL where your site is published</span>
                                </div>
                                
                                <div class="success-box mt-4">
                                    <h5 class="font-bold mb-2">Your Site URL</h5>
                                    <p>Your AMA Portal will be available at: <code>https://[your-username].github.io/[repository-name]/</code></p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Netlify Drop Option -->
                        <div class="accordion-item mb-3">
                            <div class="accordion-header cursor-pointer flex items-center justify-between p-3 rounded">
                                <span class="font-semibold">Option 2: Netlify Drop (Easiest Method)</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content hidden p-3 rounded-b">
                                <p class="mb-3">Netlify Drop is the simplest way to host your AMA portal - just drag and drop:</p>
                                
                                <div class="mb-3">
                                    <span class="step-number">1</span>
                                    <span>Save this HTML file to your computer and rename it to "index.html"</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">2</span>
                                    <span>Go to <a href="https://app.netlify.com/drop" target="_blank" class="text-blue-600 underline">netlify.com/drop</a></span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">3</span>
                                    <span>Drag and drop the "index.html" file directly onto the Netlify Drop zone</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">4</span>
                                    <span>That's it! Your site will be instantly deployed</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">5</span>
                                    <span>(Optional) Create a Netlify account to customize the URL</span>
                                </div>
                                
                                <div class="success-box mt-4">
                                    <h5 class="font-bold mb-2">Your Site URL</h5>
                                    <p>Your AMA Portal will be available at a random URL like: <code>https://random-name-123456.netlify.app</code></p>
                                    <p class="mt-2">You can sign up for a free Netlify account to customize this URL.</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Vercel Option -->
                        <div class="accordion-item mb-3">
                            <div class="accordion-header cursor-pointer flex items-center justify-between p-3 rounded">
                                <span class="font-semibold">Option 3: Vercel (Another Simple Option)</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content hidden p-3 rounded-b">
                                <p class="mb-3">Vercel provides an easy way to deploy static websites:</p>
                                
                                <div class="mb-3">
                                    <span class="step-number">1</span>
                                    <span>Save this HTML file to your computer and rename it to "index.html"</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">2</span>
                                    <span>Go to <a href="https://vercel.com" target="_blank" class="text-blue-600 underline">vercel.com</a> and sign up with GitHub, GitLab, or email</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">3</span>
                                    <span>Click "New Project" on the Vercel dashboard</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">4</span>
                                    <span>Click "Upload" in the bottom section and select your index.html file</span>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="step-number">5</span>
                                    <span>Vercel will automatically deploy your site</span>
                                </div>
                                
                                <div class="success-box mt-4">
                                    <h5 class="font-bold mb-2">Your Site URL</h5>
                                    <p>Your AMA Portal will be available at: <code>https://your-project-name.vercel.app</code></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mb-6">
                <h3 class="text-xl font-semibold mb-2">Admin Security</h3>
                <div class="card p-4 admin-panel-card">
                    <div class="mb-4">
                        <label class="form-label" for="adminPassword">Change Admin Password</label>
                        <input type="password" id="adminPassword" class="form-input" placeholder="Enter new admin password">
                    </div>
                    
                    <button id="saveAdminPassword" class="btn-primary">Update Password</button>
                </div>
            </div>
        </div>

        <!-- Modal for Admin Login -->
        <div id="adminLoginModal" class="modal">
            <div class="modal-content">
                <h2 class="text-2xl font-bold mb-4">Admin Login</h2>
                <form id="adminLoginForm">
                    <div class="mb-4">
                        <label class="form-label" for="adminLoginPassword">Password</label>
                        <input type="password" id="adminLoginPassword" class="form-input" placeholder="Enter admin password" required>
                    </div>
                    
                    <div class="flex justify-end">
                        <button type="button" class="btn-secondary mr-2" id="cancelAdminLogin">Cancel</button>
                        <button type="submit" class="btn-primary">Login</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal for Responding to Questions -->
        <div id="responseModal" class="modal">
            <div class="modal-content">
                <h2 class="text-2xl font-bold mb-4">Respond to Question</h2>
                <div id="responseQuestionDetails" class="mb-4 pb-4 border-b border-gray-300"></div>
                
                <form id="responseForm">
                    <input type="hidden" id="responseQuestionId">
                    
                    <div class="mb-4">
                        <label class="form-label" for="responseContent">Your Response</label>
                        <textarea id="responseContent" class="form-textarea" rows="4" placeholder="Type your response..." required></textarea>
                    </div>
                    
                    <div id="responseEmailInfo" class="mb-4 info-box">
                        <p>Notification will be sent to: <span id="responseEmailAddress">No email provided</span></p>
                    </div>
                    
                    <div class="flex justify-end">
                        <button type="button" class="btn-secondary mr-2" id="cancelResponse">Cancel</button>
                        <button type="submit" id="submitResponseBtn" class="btn-primary">Submit Response</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal for Adding Leadership Updates -->
        <div id="updateModal" class="modal">
            <div class="modal-content">
                <h2 class="text-2xl font-bold mb-4">Add Leadership Update</h2>
                
                <form id="updateForm">
                    <input type="hidden" id="updateId" value="">
                    <div class="mb-4">
                        <label class="form-label" for="updateTitle">Update Title</label>
                        <input type="text" id="updateTitle" class="form-input" placeholder="Title of your update" required>
                    </div>
                    
                    <div class="mb-4">
                        <label class="form-label" for="updateContent">Update Content</label>
                        <textarea id="updateContent" class="form-textarea" rows="6" placeholder="Share your update with the team..." required></textarea>
                    </div>
                    
                    <div class="flex justify-end">
                        <button type="button" class="btn-secondary mr-2" id="cancelUpdate">Cancel</button>
                        <button type="submit" class="btn-primary" id="publishUpdateBtn">Publish Update</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal for Deleting Questions -->
        <div id="deleteModal" class="modal">
            <div class="modal-content">
                <h2 class="text-2xl font-bold mb-4">Delete Question</h2>
                <p class="mb-6">Are you sure you want to delete this question? This action cannot be undone.</p>
                
                <div id="deleteQuestionDetails" class="mb-4 pb-4 border-b border-gray-300 text-gray-600"></div>
                
                <input type="hidden" id="deleteQuestionId">
                
                <div class="flex justify-end mt-6">
                    <button type="button" class="btn-secondary mr-2" id="cancelDelete">Cancel</button>
                    <button type="button" class="btn-danger" id="confirmDelete">Delete Question</button>
                </div>
            </div>
        </div>

        <!-- Modal for Deleting Leadership Updates -->
        <div id="deleteUpdateModal" class="modal">
            <div class="modal-content">
                <h2 class="text-2xl font-bold mb-4">Delete Leadership Update</h2>
                <p class="mb-6">Are you sure you want to delete this leadership update? This action cannot be undone.</p>
                
                <div id="deleteUpdateDetails" class="mb-4 pb-4 border-b border-gray-300 text-gray-600"></div>
                
                <input type="hidden" id="deleteUpdateId">
                
                <div class="flex justify-end mt-6">
                    <button type="button" class="btn-secondary mr-2" id="cancelDeleteUpdate">Cancel</button>
                    <button type="button" class="btn-danger" id="confirmDeleteUpdate">Delete Update</button>
                </div>
            </div>
        </div>

        <!-- Email Preview Modal -->
        <div id="emailPreviewModal" class="modal">
            <div class="modal-content">
                <h2 class="text-2xl font-bold mb-4">Email Preview</h2>
                
                <div class="mb-4">
                    <h3 class="text-lg font-semibold mb-2">New Question Notification (to Admin)</h3>
                    <div class="email-preview">
                        <div class="email-preview-header">
                            <div>To: james.neo@chrobinson.com</div>
                            <div>Subject: New Question Submitted - APAC Finance Leadership AMA</div>
                        </div>
                        <div class="mt-3">
                            <p>A new question has been submitted in the APAC Finance Leadership AMA portal:</p>
                            <p class="mt-2"><strong>Title:</strong> [Question Title]</p>
                            <p><strong>Topic:</strong> [Topic]</p>
                            <p><strong>Submitted by:</strong> [Name]</p>
                            <p class="mt-2"><strong>Question:</strong></p>
                            <p>[Question Content]</p>
                            <p class="mt-3">Please log in to the AMA portal to respond.</p>
                        </div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h3 class="text-lg font-semibold mb-2">Response Notification (to Employee)</h3>
                    <div class="email-preview">
                        <div class="email-preview-header">
                            <div>To: [Employee Email]</div>
                            <div>Subject: Your Question Has Been Answered - APAC Finance Leadership AMA</div>
                        </div>
                        <div class="mt-3">
                            <p>Your question in the APAC Finance Leadership AMA portal has received a response:</p>
                            <p class="mt-2"><strong>Your Question:</strong> [Question Title]</p>
                            <p class="mt-2"><strong>Response:</strong></p>
                            <p>[Response Content]</p>
                            <p class="mt-3">You can view the full response and other questions in the AMA portal.</p>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end mt-4">
                    <button id="closeEmailPreview" class="btn-secondary">Close</button>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div id="toast" class="fixed bottom-4 right-4 px-4 py-2 rounded-lg bg-gray-800 text-white shadow-lg transform transition-transform duration-300 translate-y-20 opacity-0">
            <span id="toastMessage">Notification message</span>
        </div>

        <script>
            // Global variables and state
            let questions = [];
            let leadershipUpdates = [];
            let isAdmin = false;
            let lastUpdateTimestamp = 0;
            let newContentAvailable = false;
            let autoRefreshEnabled = true;
            let autoRefreshInterval = null;
            let autoRefreshTimer = 30; // seconds
            const defaultAdminPassword = 'admin123';
            const adminEmail = 'james.neo@chrobinson.com';
            
            // DOM Elements
            const questionsContainer = document.getElementById('questionsContainer');
            const leadershipUpdatesContainer = document.getElementById('leadershipUpdatesContainer');
            const updatesContent = document.getElementById('updatesContent');
            const submitQuestionForm = document.getElementById('submitQuestionForm');
            const adminPanel = document.getElementById('adminPanel');
            const adminTabs = document.getElementById('adminTabs');
            const adminLoginBtn = document.getElementById('adminLoginBtn');
            const adminLogoutBtn = document.getElementById('adminLogoutBtn');
            const adminLoginModal = document.getElementById('adminLoginModal');
            const responseModal = document.getElementById('responseModal');
            const updateModal = document.getElementById('updateModal');
            const deleteModal = document.getElementById('deleteModal');
            const deleteUpdateModal = document.getElementById('deleteUpdateModal');
            const emailPreviewModal = document.getElementById('emailPreviewModal');
            const toast = document.getElementById('toast');
            const refreshBar = document.getElementById('refreshBar');
            const refreshIndicator = document.getElementById('refreshIndicator');
            const refreshStatus = document.getElementById('refreshStatus');
            const manualRefreshBtn = document.getElementById('manualRefreshBtn');
            const autoRefreshToggle = document.getElementById('autoRefreshToggle');
            
            // Initialize app on load
            document.addEventListener('DOMContentLoaded', () => {
                initializeApp();
                setupEventListeners();
                setupAccordion();
                setupAutoRefresh();
            });

            // App initialization
            function initializeApp() {
                loadDataFromLocalStorage();
                lastUpdateTimestamp = getCurrentTimestamp();
                displayQuestions();
                displayLeadershipUpdates();
                updateAdminUI();
                showRefreshBar();
            }

            // Setup auto-refresh functionality
            function setupAutoRefresh() {
                // Initial state
                autoRefreshEnabled = localStorage.getItem('amaAutoRefresh') !== 'false';
                autoRefreshToggle.checked = autoRefreshEnabled;
                
                // Set up auto-refresh interval
                if (autoRefreshEnabled) {
                    startAutoRefresh();
                }
            }

            // Start auto-refresh timer
            function startAutoRefresh() {
                if (autoRefreshInterval) {
                    clearInterval(autoRefreshInterval);
                }
                
                autoRefreshInterval = setInterval(() => {
                    checkForNewContent();
                }, autoRefreshTimer * 1000);
            }

            // Stop auto-refresh timer
            function stopAutoRefresh() {
                if (autoRefreshInterval) {
                    clearInterval(autoRefreshInterval);
                    autoRefreshInterval = null;
                }
            }

            // Toggle auto-refresh
            function toggleAutoRefresh() {
                autoRefreshEnabled = autoRefreshToggle.checked;
                localStorage.setItem('amaAutoRefresh', autoRefreshEnabled);
                
                if (autoRefreshEnabled) {
                    startAutoRefresh();
                    showToast('Auto-refresh enabled');
                } else {
                    stopAutoRefresh();
                    showToast('Auto-refresh disabled');
                }
            }

            // Get current timestamp
            function getCurrentTimestamp() {
                return Math.floor(Date.now() / 1000);
            }

            // Check for new content
            function checkForNewContent() {
                refreshIndicator.className = 'refresh-indicator checking';
                refreshStatus.textContent = 'Checking for new content...';
                
                // Capture previous timestamp for comparison
                const previousTimestamp = lastUpdateTimestamp;
                
                // Get all content from all users
                refreshFromLocalStorage();
                
                // Check if there's new content
                setTimeout(() => {
                    let newContent = false;
                    
                    // Check for new questions (from other users)
                    const newQuestionTimestamps = getLocalStorageFromOtherUsers('amaQuestions');
                    if (newQuestionTimestamps.length > 0) {
                        newContent = true;
                        loadDataFromLocalStorage();
                        displayQuestions();
                    }
                    
                    // Check for new leadership updates
                    const newUpdateTimestamps = getLocalStorageFromOtherUsers('amaLeadershipUpdates');
                    if (newUpdateTimestamps.length > 0) {
                        newContent = true;
                        loadDataFromLocalStorage();
                        if (document.getElementById('tabLeadershipUpdates').classList.contains('tab-active')) {
                            displayLeadershipUpdates();
                        }
                    }
                    
                    if (newContent) {
                        newContentAvailable = true;
                        refreshIndicator.className = 'refresh-indicator new-content';
                        refreshStatus.textContent = 'New content available!';
                        showToast('New content has been loaded', 'info');
                    } else {
                        newContentAvailable = false;
                        refreshIndicator.className = 'refresh-indicator';
                        refreshStatus.textContent = 'Content is up to date';
                    }
                    
                    lastUpdateTimestamp = getCurrentTimestamp();
                }, 500);
            }

            // Manually refresh content
            function manualRefresh() {
                refreshIndicator.className = 'refresh-indicator checking';
                refreshStatus.textContent = 'Refreshing content...';
                manualRefreshBtn.disabled = true;
                manualRefreshBtn.innerHTML = '<div class="loading-spinner mr-2"></div> Refreshing...';
                
                // Refresh data from localStorage
                refreshFromLocalStorage();
                
                // Wait a moment to simulate network activity
                setTimeout(() => {
                    loadDataFromLocalStorage();
                    
                    // Update current view
                    if (document.getElementById('tabAllQuestions').classList.contains('tab-active')) {
                        displayQuestions();
                    } else if (document.getElementById('tabLeadershipUpdates').classList.contains('tab-active')) {
                        displayLeadershipUpdates();
                    }
                    
                    // Reset UI
                    newContentAvailable = false;
                    refreshIndicator.className = 'refresh-indicator';
                    refreshStatus.textContent = 'Content refreshed';
                    manualRefreshBtn.disabled = false;
                    manualRefreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Refresh';
                    lastUpdateTimestamp = getCurrentTimestamp();
                    
                    showToast('Content refreshed successfully', 'success');
                }, 800);
            }

            // Get timestamps of localStorage entries from other users/sessions
            function getLocalStorageFromOtherUsers(storageKey) {
                const newTimestamps = [];
                try {
                    // Compare current data with stored timestamps
                    const lastCheck = lastUpdateTimestamp;
                    
                    // Get content from localStorage
                    if (storageKey === 'amaQuestions') {
                        const storedQuestions = JSON.parse(localStorage.getItem('amaQuestions') || '[]');
                        for (const question of storedQuestions) {
                            const questionTime = new Date(question.date).getTime() / 1000;
                            if (questionTime > lastCheck) {
                                newTimestamps.push(questionTime);
                            }
                        }
                    } else if (storageKey === 'amaLeadershipUpdates') {
                        const storedUpdates = JSON.parse(localStorage.getItem('amaLeadershipUpdates') || '[]');
                        for (const update of storedUpdates) {
                            const updateTime = new Date(update.date).getTime() / 1000;
                            if (updateTime > lastCheck) {
                                newTimestamps.push(updateTime);
                            }
                        }
                    }
                } catch (error) {
                    console.error('Error checking for new content:', error);
                }
                
                return newTimestamps;
            }

            // Refresh data from localStorage from all sources
            function refreshFromLocalStorage() {
                // This function simulates getting the latest data
                // In a real implementation, this would fetch data from a server
                // Here we're just re-reading from localStorage
                return true;
            }

            // Show the refresh bar
            function showRefreshBar() {
                refreshBar.style.display = 'flex';
            }

            // Load data from localStorage
            function loadDataFromLocalStorage() {
                try {
                    // Load questions
                    const savedQuestions = localStorage.getItem('amaQuestions');
                    if (savedQuestions) {
                        questions = JSON.parse(savedQuestions);
                    } else {
                        // Sample questions for first-time users
                        questions = [
                            {
                                id: 'q1',
                                title: 'When will the next salary review happen?',
                                content: 'I was wondering about the timeline for the next salary review cycle.',
                                topic: 'compensation',
                                submitter: 'Anonymous',
                                email: '',
                                date: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
                                upvotes: 12,
                                upvotedBy: [],
                                response: 'The next salary review will happen in April 2023. We will communicate the exact dates as we get closer to the review period.',
                                responseDate: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString()
                            },
                            {
                                id: 'q2',
                                title: 'Are there plans to expand our team in APAC?',
                                content: 'I\'ve noticed increased workload and was wondering if there are plans to hire more people in the Finance department.',
                                topic: 'strategy',
                                submitter: 'Jane Smith',
                                email: '',
                                date: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000).toISOString(),
                                upvotes: 8,
                                upvotedBy: [],
                                response: '',
                                responseDate: ''
                            },
                            {
                                id: 'q3',
                                title: 'Can we get more information about the flexible benefits package?',
                                content: 'I would like to understand how we can best utilize the flexible benefits offered by the company.',
                                topic: 'benefits',
                                submitter: 'Anonymous',
                                email: '',
                                date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
                                upvotes: 15,
                                upvotedBy: [],
                                response: 'Great question! We will be hosting an information session about flexible benefits on June 15th. Details will be sent via email next week.',
                                responseDate: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString()
                            }
                        ];
                        saveQuestionsToLocalStorage();
                    }

                    // Load leadership updates
                    const savedUpdates = localStorage.getItem('amaLeadershipUpdates');
                    if (savedUpdates) {
                        leadershipUpdates = JSON.parse(savedUpdates);
                    } else {
                        // Sample leadership update for first-time users
                        leadershipUpdates = [
                            {
                                id: 'u1',
                                title: 'Q2 Financial Results',
                                content: 'We are pleased to announce that our Q2 financial results exceeded expectations. The Finance team has done an exceptional job managing costs while supporting business growth. \n\nThank you for your continued dedication and hard work.',
                                date: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString()
                            }
                        ];
                        saveUpdatesToLocalStorage();
                    }

                    // Load admin settings
                    const savedAdminPassword = localStorage.getItem('amaAdminPassword');
                    if (savedAdminPassword) {
                        adminPassword = savedAdminPassword;
                    } else {
                        localStorage.setItem('amaAdminPassword', defaultAdminPassword);
                    }
                } catch (error) {
                    console.error('Error loading data from localStorage:', error);
                    showToast('Error loading data. Starting with empty state.', 'error');
                    questions = [];
                    leadershipUpdates = [];
                }
            }

            // Save questions to localStorage
            function saveQuestionsToLocalStorage() {
                try {
                    localStorage.setItem('amaQuestions', JSON.stringify(questions));
                } catch (error) {
                    console.error('Error saving questions to localStorage:', error);
                    showToast('Error saving question data.', 'error');
                }
            }

            // Save leadership updates to localStorage
            function saveUpdatesToLocalStorage() {
                try {
                    localStorage.setItem('amaLeadershipUpdates', JSON.stringify(leadershipUpdates));
                } catch (error) {
                    console.error('Error saving updates to localStorage:', error);
                    showToast('Error saving leadership updates.', 'error');
                }
            }

            // Display questions in the container
            function displayQuestions() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const topicFilter = document.getElementById('topicFilter').value;
                const sortFilter = document.getElementById('sortFilter').value;
                
                // Filter questions based on search and topic
                let filteredQuestions = questions.filter(question => {
                    const matchesSearch = 
                        question.title.toLowerCase().includes(searchTerm) || 
                        question.content.toLowerCase().includes(searchTerm);
                    
                    const matchesTopic = topicFilter === 'all' || question.topic === topicFilter;
                    
                    return matchesSearch && matchesTopic;
                });
                
                // Sort questions
                if (sortFilter === 'popular') {
                    filteredQuestions.sort((a, b) => b.upvotes - a.upvotes);
                } else {
                    filteredQuestions.sort((a, b) => new Date(b.date) - new Date(a.date));
                }
                
                // Render the HTML
                if (filteredQuestions.length === 0) {
                    questionsContainer.innerHTML = `
                        <div class="text-center py-8">
                            <i class="fas fa-search text-4xl mb-4 text-gray-500"></i>
                            <p class="text-gray-600">No questions found. Try adjusting your filters or be the first to ask!</p>
                        </div>
                    `;
                    return;
                }
                
                questionsContainer.innerHTML = filteredQuestions.map(question => {
                    const topicClass = `badge-${question.topic}`;
                    const topicText = {
                        'benefits': 'Employee Benefits',
                        'compensation': 'Compensation',
                        'strategy': 'Strategy & Direction',
                        'others': 'Others'
                    }[question.topic] || question.topic;
                    
                    const date = new Date(question.date);
                    const formattedDate = `${date.toLocaleDateString()} at ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
                    
                    const adminControls = isAdmin ? `
                        <div class="flex space-x-2 mt-2">
                            ${!question.response ? `
                                <button class="btn-primary respond-btn" data-id="${question.id}">
                                    <i class="fas fa-reply mr-1"></i> Respond
                                </button>
                            ` : `
                                <button class="btn-secondary respond-btn" data-id="${question.id}">
                                    <i class="fas fa-edit mr-1"></i> Edit Response
                                </button>
                            `}
                            <button class="btn-danger delete-btn" data-id="${question.id}">
                                <i class="fas fa-trash-alt mr-1"></i> Delete
                            </button>
                        </div>
                    ` : '';
                    
                    return `
                    <div class="card question-card p-4 mb-4" data-id="${question.id}">
                        <div class="flex items-start">
                            <div class="mr-4 text-center">
                                <button class="upvote-btn flex flex-col items-center ${question.upvotedBy.includes(getClientId()) ? 'upvoted' : ''}" data-id="${question.id}">
                                    <i class="fas fa-chevron-up text-xl"></i>
                                    <span class="text-lg font-semibold">${question.upvotes}</span>
                                </button>
                            </div>
                            
                            <div class="flex-1">
                                <h3 class="text-xl font-bold mb-2">${escapeHtml(question.title)}</h3>
                                
                                <div class="flex flex-wrap items-center mb-3">
                                    <span class="badge ${topicClass} mr-2">${topicText}</span>
                                    <span class="text-gray-600 text-sm">
                                        Asked by ${escapeHtml(question.submitter)} on ${formattedDate}
                                    </span>
                                </div>
                                
                                <div class="mb-4 whitespace-pre-line">${escapeHtml(question.content)}</div>
                                
                                ${question.response ? `
                                <div class="mt-4 border-t border-gray-300 pt-4">
                                    <h4 class="font-semibold text-green-600 mb-2">Response:</h4>
                                    <div class="whitespace-pre-line">${escapeHtml(question.response)}</div>
                                    <div class="text-gray-600 text-sm mt-2">
                                        Answered on ${new Date(question.responseDate).toLocaleDateString()}
                                    </div>
                                </div>
                                ${isAdmin ? adminControls : ''}
                                ` : (isAdmin ? adminControls : `
                                <div class="mt-4 text-gray-600 italic">
                                    <i class="fas fa-hourglass-half mr-1"></i> Awaiting response
                                </div>
                                `)}
                            </div>
                        </div>
                    </div>
                    `;
                }).join('');
                
                // Add event listeners to upvote buttons
                document.querySelectorAll('.upvote-btn').forEach(button => {
                    button.addEventListener('click', handleUpvote);
                });
                
                // Add event listeners to admin buttons (for admin)
                if (isAdmin) {
                    document.querySelectorAll('.respond-btn').forEach(button => {
                        button.addEventListener('click', openResponseModal);
                    });
                    
                    document.querySelectorAll('.delete-btn').forEach(button => {
                        button.addEventListener('click', openDeleteModal);
                    });
                }
            }

            // Display leadership updates
            function displayLeadershipUpdates() {
                if (leadershipUpdates.length === 0) {
                    updatesContent.innerHTML = `
                        <div class="text-center py-8">
                            <i class="fas fa-info-circle text-4xl mb-4 text-gray-500"></i>
                            <p class="text-gray-600">No updates available yet.</p>
                        </div>
                    `;
                    return;
                }
                
                // Sort updates by date (newest first)
                const sortedUpdates = [...leadershipUpdates].sort((a, b) => new Date(b.date) - new Date(a.date));
                
                updatesContent.innerHTML = sortedUpdates.map(update => {
                    const date = new Date(update.date);
                    const formattedDate = `${date.toLocaleDateString()} at ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
                    
                    const adminButtons = isAdmin ? `
                        <div class="flex mt-3 space-x-2">
                            <button class="btn-secondary edit-update-btn" data-id="${update.id}">
                                <i class="fas fa-edit mr-1"></i> Edit
                            </button>
                            <button class="btn-danger delete-update-btn" data-id="${update.id}">
                                <i class="fas fa-trash-alt mr-1"></i> Delete
                            </button>
                        </div>
                    ` : '';
                    
                    return `
                    <div class="update-card" data-id="${update.id}">
                        <div class="timestamp">Posted on ${formattedDate}</div>
                        <h3 class="text-xl font-bold mb-2">${escapeHtml(update.title)}</h3>
                        <div class="update-content">${escapeHtml(update.content)}</div>
                        ${adminButtons}
                    </div>
                    `;
                }).join('');
                
                // Add event listeners to admin buttons (for admin)
                if (isAdmin) {
                    document.querySelectorAll('.edit-update-btn').forEach(button => {
                        button.addEventListener('click', function(e) {
                            const updateId = e.currentTarget.getAttribute('data-id');
                            openEditUpdateModal(updateId);
                        });
                    });
                    
                    document.querySelectorAll('.delete-update-btn').forEach(button => {
                        button.addEventListener('click', function(e) {
                            const updateId = e.currentTarget.getAttribute('data-id');
                            openDeleteUpdateModal(updateId);
                        });
                    });
                }
            }

            // Handle upvoting a question
            function handleUpvote(e) {
                const questionId = e.currentTarget.getAttribute('data-id');
                const clientId = getClientId();
                
                const questionIndex = questions.findIndex(q => q.id === questionId);
                if (questionIndex === -1) return;
                
                const question = questions[questionIndex];
                
                // Toggle upvote
                if (question.upvotedBy.includes(clientId)) {
                    question.upvotes--;
                    question.upvotedBy = question.upvotedBy.filter(id => id !== clientId);
                    e.currentTarget.classList.remove('upvoted');
                } else {
                    question.upvotes++;
                    question.upvotedBy.push(clientId);
                    e.currentTarget.classList.add('upvoted');
                }
                
                // Update the display
                e.currentTarget.querySelector('span').textContent = question.upvotes;
                
                // Save to localStorage
                saveQuestionsToLocalStorage();
            }

            // Get a unique client ID for tracking upvotes
            function getClientId() {
                let clientId = localStorage.getItem('amaClientId');
                if (!clientId) {
                    clientId = 'client_' + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem('amaClientId', clientId);
                }
                return clientId;
            }

            // Submit a new question with AJAX to avoid redirects
            function submitQuestion(e) {
                e.preventDefault();
                
                // Disable the submit button and show loading state
                const submitButton = document.getElementById('submitQuestionBtn');
                const originalButtonText = submitButton.innerHTML;
                submitButton.disabled = true;
                submitButton.innerHTML = `<div class="loading-spinner mr-2"></div> Submitting...`;
                
                const title = document.getElementById('questionTitle').value.trim();
                const content = document.getElementById('questionContent').value.trim();
                const topic = document.getElementById('questionTopic').value;
                const submitter = document.getElementById('submitterName').value.trim() || 'Anonymous';
                const email = document.getElementById('submitterEmail').value.trim();
                
                if (!title || !content || !topic) {
                    showToast('Please fill in all required fields.', 'error');
                    submitButton.disabled = false;
                    submitButton.innerHTML = originalButtonText;
                    return;
                }
                
                const newQuestion = {
                    id: 'q' + Date.now(),
                    title,
                    content,
                    topic,
                    submitter,
                    email,
                    date: new Date().toISOString(),
                    upvotes: 0,
                    upvotedBy: [],
                    response: '',
                    responseDate: ''
                };
                
                // Add to questions array
                questions.unshift(newQuestion);
                
                // Save to localStorage
                saveQuestionsToLocalStorage();
                
                // Prepare form data for email
                const topicText = getTopicName(topic);
                
                // Update email status
                updateEmailStatus("Sending email notification to admin...");
                
                // Create FormData object for the AJAX request
                const formData = new FormData();
                formData.append('_subject', 'New Question Submitted - APAC Finance Leadership AMA');
                formData.append('_template', 'table');
                formData.append('_captcha', 'false');
                formData.append('Question Title', title);
                formData.append('Topic', topicText);
                formData.append('Submitted By', submitter);
                formData.append('Question Details', content);
                
                // Use fetch API to send the form data without redirects
                fetch('https://formsubmit.co/ajax/' + adminEmail, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        updateEmailStatus("Email notification sent to admin successfully");
                        showToast('Your question has been submitted and admin has been notified', 'success');
                    } else {
                        throw new Error('Form submission failed');
                    }
                })
                .catch(error => {
                    console.error("Failed to send email notification:", error);
                    updateEmailStatus("Failed to send email notification, but your question has been saved", true);
                    showToast('Question submitted, but admin notification failed', 'warning');
                })
                .finally(() => {
                    // Reset form and button state
                    document.getElementById('questionForm').reset();
                    submitButton.disabled = false;
                    submitButton.innerHTML = originalButtonText;
                    
                    // Switch to questions tab
                    showTab('tabAllQuestions');
                    
                    // Update display
                    displayQuestions();
                });
            }

            // Submit a response to a question with AJAX to avoid redirects
            function submitResponse(e) {
                e.preventDefault();
                
                // Disable the submit button and show loading state
                const submitButton = document.getElementById('submitResponseBtn');
                const originalButtonText = submitButton.innerHTML;
                submitButton.disabled = true;
                submitButton.innerHTML = `<div class="loading-spinner mr-2"></div> Submitting...`;
                
                const questionId = document.getElementById('responseQuestionId').value;
                const response = document.getElementById('responseContent').value.trim();
                
                if (!response) {
                    showToast('Please enter a response.', 'error');
                    submitButton.disabled = false;
                    submitButton.innerHTML = originalButtonText;
                    return;
                }
                
                const questionIndex = questions.findIndex(q => q.id === questionId);
                if (questionIndex === -1) {
                    submitButton.disabled = false;
                    submitButton.innerHTML = originalButtonText;
                    return;
                }
                
                const question = questions[questionIndex];
                const isNewResponse = !question.response;
                
                question.response = response;
                question.responseDate = new Date().toISOString();
                
                // Save to localStorage
                saveQuestionsToLocalStorage();
                
                // If the question submitter provided an email, send notification
                if (question.email) {
                    // Update status
                    updateEmailStatus("Sending notification to employee...");
                    
                    // Create FormData object for the AJAX request
                    const formData = new FormData();
                    formData.append('_subject', 'Your Question Has Been Answered - APAC Finance Leadership AMA');
                    formData.append('_template', 'table');
                    formData.append('_captcha', 'false');
                    formData.append('Your Question', question.title);
                    formData.append('Response', response);
                    
                    // Use fetch API to send the form data without redirects
                    fetch('https://formsubmit.co/ajax/' + question.email, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'Accept': 'application/json'
                        }
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            updateEmailStatus("Email notification sent to employee successfully");
                            showToast('Response submitted and employee has been notified', 'success');
                        } else {
                            throw new Error('Form submission failed');
                        }
                    })
                    .catch(error => {
                        console.error("Failed to send employee notification:", error);
                        updateEmailStatus("Failed to send employee notification, but response has been saved", true);
                        showToast('Response submitted, but employee notification failed', 'warning');
                    })
                    .finally(() => {
                        // Reset button state
                        submitButton.disabled = false;
                        submitButton.innerHTML = originalButtonText;
                        
                        // Close modal
                        closeResponseModal();
                        
                        // Update display
                        displayQuestions();
                    });
                } else {
                    // No email to notify, just show success
                    submitButton.disabled = false;
                    submitButton.innerHTML = originalButtonText;
                    closeResponseModal();
                    showToast(isNewResponse ? 'Response submitted successfully!' : 'Response updated successfully!', 'success');
                    displayQuestions();
                }
            }

            // Submit a new leadership update or edit existing one
            function submitUpdate(e) {
                e.preventDefault();
                
                const title = document.getElementById('updateTitle').value.trim();
                const content = document.getElementById('updateContent').value.trim();
                const updateId = document.getElementById('updateId').value;
                
                if (!title || !content) {
                    showToast('Please fill in all fields.', 'error');
                    return;
                }
                
                // Check if we're editing or adding
                if (updateId) {
                    // Edit existing update
                    const updateIndex = leadershipUpdates.findIndex(u => u.id === updateId);
                    if (updateIndex !== -1) {
                        // Preserve the original date
                        const originalDate = leadershipUpdates[updateIndex].date;
                        leadershipUpdates[updateIndex] = {
                            id: updateId,
                            title,
                            content,
                            date: originalDate
                        };
                        showToast('Leadership update edited successfully!', 'success');
                    }
                } else {
                    // Add new update
                    const newUpdate = {
                        id: 'u' + Date.now(),
                        title,
                        content,
                        date: new Date().toISOString()
                    };
                    leadershipUpdates.unshift(newUpdate);
                    showToast('Leadership update published successfully!', 'success');
                }
                
                // Save to localStorage
                saveUpdatesToLocalStorage();
                
                // Reset form and close modal
                document.getElementById('updateForm').reset();
                document.getElementById('updateId').value = '';
                document.getElementById('publishUpdateBtn').textContent = 'Publish Update';
                closeUpdateModal();
                
                // Update display
                displayLeadershipUpdates();
            }

            // Delete a question
            function deleteQuestion() {
                const questionId = document.getElementById('deleteQuestionId').value;
                
                questions = questions.filter(q => q.id !== questionId);
                
                // Save to localStorage
                saveQuestionsToLocalStorage();
                
                // Close modal
                closeDeleteModal();
                
                // Show success message
                showToast('Question deleted successfully.', 'success');
                
                // Update display
                displayQuestions();
            }

            // Delete a leadership update
            function deleteUpdate() {
                const updateId = document.getElementById('deleteUpdateId').value;
                
                leadershipUpdates = leadershipUpdates.filter(u => u.id !== updateId);
                
                // Save to localStorage
                saveUpdatesToLocalStorage();
                
                // Close modal
                closeDeleteUpdateModal();
                
                // Show success message
                showToast('Leadership update deleted successfully.', 'success');
                
                // Update display
                displayLeadershipUpdates();
            }

            // Test the email system with AJAX to avoid redirects
            function testEmailSystem() {
                updateEmailStatus("Testing email system...");
                
                // Create FormData object for the AJAX request
                const formData = new FormData();
                formData.append('_subject', 'APAC Finance AMA - Email System Test');
                formData.append('_template', 'table');
                formData.append('_captcha', 'false');
                formData.append('Message', 'This is a test email to verify that the notification system is working correctly. If you received this, the email system is functioning properly.');
                
                // Use fetch API to send the form data without redirects
                fetch('https://formsubmit.co/ajax/' + adminEmail, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        updateEmailStatus("Test email sent successfully");
                        showToast('Test email sent successfully!', 'success');
                    } else {
                        throw new Error('Form submission failed');
                    }
                })
                .catch(error => {
                    console.error("Test email failed:", error);
                    updateEmailStatus("Test email failed: " + error.message, true);
                    showToast('Test email failed', 'error');
                });
            }

            // Update the email status indicator
            function updateEmailStatus(status, isError = false) {
                const statusElement = document.getElementById('emailStatus');
                const indicatorElement = document.getElementById('emailStatusIndicator');
                
                if (!statusElement || !indicatorElement) return;
                
                statusElement.textContent = status;
                
                if (isError) {
                    indicatorElement.className = 'error-box';
                    indicatorElement.innerHTML = `<p><i class="fas fa-exclamation-circle mr-2"></i>Email system status: <span id="emailStatus">${status}</span></p>`;
                } else {
                    indicatorElement.className = 'info-box';
                    indicatorElement.innerHTML = `<p><i class="fas fa-info-circle mr-2"></i>Email system status: <span id="emailStatus">${status}</span></p>`;
                }
            }

            // Helper function to get topic name from value
            function getTopicName(topicValue) {
                const topicMap = {
                    'benefits': 'Employee Benefits',
                    'compensation': 'Compensation',
                    'strategy': 'Strategy & Direction',
                    'others': 'Others'
                };
                return topicMap[topicValue] || topicValue;
            }

            // Setup accordion functionality
            function setupAccordion() {
                document.querySelectorAll('.accordion-header').forEach(header => {
                    header.addEventListener('click', () => {
                        const content = header.nextElementSibling;
                        const icon = header.querySelector('i');
                        
                        // Toggle content visibility
                        content.classList.toggle('hidden');
                        
                        // Toggle icon
                        if (content.classList.contains('hidden')) {
                            icon.className = 'fas fa-chevron-down';
                        } else {
                            icon.className = 'fas fa-chevron-up';
                        }
                    });
                });
            }

            // Tab navigation
            function showTab(tabId) {
                // Hide all content sections
                submitQuestionForm.style.display = 'none';
                adminPanel.style.display = 'none';
                questionsContainer.style.display = 'none';
                leadershipUpdatesContainer.style.display = 'none';
                document.getElementById('searchFilterBar').style.display = 'none';
                refreshBar.style.display = 'none';
                
                // Remove active class from all tabs
                document.querySelectorAll('.tab-active').forEach(tab => {
                    tab.classList.remove('tab-active');
                });
                
                // Show appropriate content and mark tab as active
                if (tabId === 'tabSubmitQuestion') {
                    submitQuestionForm.style.display = 'block';
                    document.getElementById(tabId).classList.add('tab-active');
                } else if (tabId === 'tabLeadershipUpdates') {
                    leadershipUpdatesContainer.style.display = 'block';
                    refreshBar.style.display = 'flex';
                    document.getElementById(tabId).classList.add('tab-active');
                    displayLeadershipUpdates();
                } else if (tabId === 'tabAdminPanel' && isAdmin) {
                    adminPanel.style.display = 'block';
                    document.getElementById(tabId).classList.add('tab-active');
                } else {
                    // Default to all questions
                    questionsContainer.style.display = 'block';
                    document.getElementById('searchFilterBar').style.display = 'flex';
                    refreshBar.style.display = 'flex';
                    document.getElementById('tabAllQuestions').classList.add('tab-active');
                    displayQuestions();
                }
            }

            // Admin login
            function handleAdminLogin(e) {
                e.preventDefault();
                
                const password = document.getElementById('adminLoginPassword').value;
                const savedPassword = localStorage.getItem('amaAdminPassword') || defaultAdminPassword;
                
                if (password === savedPassword) {
                    isAdmin = true;
                    adminTabs.style.display = 'block';
                    adminLoginBtn.style.display = 'none';
                    adminLogoutBtn.style.display = 'inline-flex';
                    closeAdminLoginModal();
                    showToast('Admin login successful!', 'success');
                    updateAdminUI();
                } else {
                    showToast('Incorrect password. Please try again.', 'error');
                }
            }

            // Admin logout
            function handleAdminLogout() {
                isAdmin = false;
                adminTabs.style.display = 'none';
                adminLoginBtn.style.display = 'inline-flex';
                adminLogoutBtn.style.display = 'none';
                showToast('Logged out successfully', 'success');
                updateAdminUI();
                showTab('tabAllQuestions');
            }

            // Update admin password
            function updateAdminPassword() {
                const newPassword = document.getElementById('adminPassword').value.trim();
                
                if (!newPassword) {
                    showToast('Please enter a new password.', 'error');
                    return;
                }
                
                localStorage.setItem('amaAdminPassword', newPassword);
                document.getElementById('adminPassword').value = '';
                showToast('Admin password updated successfully!', 'success');
            }

            // Update admin UI elements
            function updateAdminUI() {
                if (isAdmin) {
                    adminTabs.style.display = 'block';
                    adminLoginBtn.style.display = 'none';
                    adminLogoutBtn.style.display = 'inline-flex';
                    document.querySelectorAll('.admin-controls').forEach(el => {
                        el.style.display = 'block';
                    });
                } else {
                    adminTabs.style.display = 'none';
                    adminLoginBtn.style.display = 'inline-flex';
                    adminLogoutBtn.style.display = 'none';
                    document.querySelectorAll('.admin-controls').forEach(el => {
                        el.style.display = 'none';
                    });
                }
                
                // Refresh the current tab view
                if (document.getElementById('tabAllQuestions').classList.contains('tab-active')) {
                    displayQuestions();
                } else if (document.getElementById('tabLeadershipUpdates').classList.contains('tab-active')) {
                    displayLeadershipUpdates();
                }
            }

            // Open the update modal for editing
            function openEditUpdateModal(updateId) {
                const update = leadershipUpdates.find(u => u.id === updateId);
                if (!update) return;
                
                document.getElementById('updateId').value = updateId;
                document.getElementById('updateTitle').value = update.title;
                document.getElementById('updateContent').value = update.content;
                document.getElementById('publishUpdateBtn').textContent = 'Update';
                
                updateModal.style.display = 'flex';
                document.getElementById('updateTitle').focus();
            }

            // Open the modal for deleting a leadership update
            function openDeleteUpdateModal(updateId) {
                const update = leadershipUpdates.find(u => u.id === updateId);
                if (!update) return;
                
                document.getElementById('deleteUpdateId').value = updateId;
                
                document.getElementById('deleteUpdateDetails').innerHTML = `
                    <h3 class="text-lg font-bold mb-1">${escapeHtml(update.title)}</h3>
                    <div class="text-sm">Posted on ${new Date(update.date).toLocaleDateString()}</div>
                `;
                
                deleteUpdateModal.style.display = 'flex';
            }

            // Modal functions
            function openAdminLoginModal() {
                adminLoginModal.style.display = 'flex';
                document.getElementById('adminLoginPassword').value = '';
                document.getElementById('adminLoginPassword').focus();
            }

            function closeAdminLoginModal() {
                adminLoginModal.style.display = 'none';
            }

            function openResponseModal(e) {
                const questionId = e.currentTarget.getAttribute('data-id');
                const question = questions.find(q => q.id === questionId);
                
                if (!question) return;
                
                document.getElementById('responseQuestionId').value = questionId;
                document.getElementById('responseContent').value = question.response || '';
                
                const topicText = getTopicName(question.topic);
                
                document.getElementById('responseQuestionDetails').innerHTML = `
                    <h3 class="text-xl font-bold mb-2">${escapeHtml(question.title)}</h3>
                    <div class="flex items-center mb-2">
                        <span class="badge badge-${question.topic} mr-2">${topicText}</span>
                        <span class="text-gray-600 text-sm">
                            Asked by ${escapeHtml(question.submitter)}
                        </span>
                    </div>
                    <div class="whitespace-pre-line">${escapeHtml(question.content)}</div>
                `;
                
                // Update email info
                const emailInfoElement = document.getElementById('responseEmailInfo');
                const emailAddressElement = document.getElementById('responseEmailAddress');
                
                if (question.email) {
                    emailInfoElement.className = 'mb-4 info-box';
                    emailAddressElement.textContent = question.email;
                } else {
                    emailInfoElement.className = 'mb-4 warning-box';
                    emailAddressElement.textContent = 'No email provided (no notification will be sent)';
                }
                
                responseModal.style.display = 'flex';
                document.getElementById('responseContent').focus();
            }

            function closeResponseModal() {
                responseModal.style.display = 'none';
            }

            function openUpdateModal() {
                document.getElementById('updateForm').reset();
                document.getElementById('updateId').value = '';
                document.getElementById('publishUpdateBtn').textContent = 'Publish Update';
                updateModal.style.display = 'flex';
                document.getElementById('updateTitle').focus();
            }

            function closeUpdateModal() {
                updateModal.style.display = 'none';
            }

            function openDeleteModal(e) {
                const questionId = e.currentTarget.getAttribute('data-id');
                const question = questions.find(q => q.id === questionId);
                
                if (!question) return;
                
                document.getElementById('deleteQuestionId').value = questionId;
                
                document.getElementById('deleteQuestionDetails').innerHTML = `
                    <h3 class="text-lg font-bold mb-1">${escapeHtml(question.title)}</h3>
                    <div class="text-sm">Asked by ${escapeHtml(question.submitter)}</div>
                `;
                
                deleteModal.style.display = 'flex';
            }

            function closeDeleteModal() {
                deleteModal.style.display = 'none';
            }

            function closeDeleteUpdateModal() {
                deleteUpdateModal.style.display = 'none';
            }

            function openEmailPreviewModal() {
                emailPreviewModal.style.display = 'flex';
            }

            function closeEmailPreviewModal() {
                emailPreviewModal.style.display = 'none';
            }

            // Toast notification
            function showToast(message, type = 'info') {
                const toastElement = document.getElementById('toast');
                const messageElement = document.getElementById('toastMessage');
                
                messageElement.textContent = message;
                
                // Set color based on type
                if (type === 'error') {
                    toastElement.classList.add('bg-red-800');
                    toastElement.classList.remove('bg-green-800', 'bg-gray-800', 'bg-yellow-800');
                } else if (type === 'success') {
                    toastElement.classList.add('bg-green-800');
                    toastElement.classList.remove('bg-red-800', 'bg-gray-800', 'bg-yellow-800');
                } else if (type === 'warning') {
                    toastElement.classList.add('bg-yellow-800');
                    toastElement.classList.remove('bg-red-800', 'bg-green-800', 'bg-gray-800');
                } else {
                    toastElement.classList.add('bg-gray-800');
                    toastElement.classList.remove('bg-red-800', 'bg-green-800', 'bg-yellow-800');
                }
                
                // Show toast
                toastElement.classList.remove('translate-y-20', 'opacity-0');
                
                // Hide after 3 seconds
                setTimeout(() => {
                    toastElement.classList.add('translate-y-20', 'opacity-0');
                }, 3000);
            }

            // HTML escape function for security
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            // Create and download the manual email links
            function setupManualEmailLinks() {
                // Admin notification email
                document.getElementById('manualAdminEmailLink').addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const subject = "New Question Submitted - APAC Finance Leadership AMA";
                    const body = "A new question has been submitted in the APAC Finance Leadership AMA portal.\n\nPlease log in to the AMA portal to view and respond.";
                    
                    window.open(`mailto:${adminEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');
                });
                
                // Employee notification email
                document.getElementById('manualEmployeeEmailLink').addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Show an input dialog for the email address
                    const employeeEmail = prompt("Enter the employee's email address:");
                    
                    if (!employeeEmail) return;
                    
                    const subject = "Your APAC Finance Leadership AMA Question Has Been Answered";
                    const body = "Your question in the APAC Finance Leadership AMA portal has received a response.\n\nPlease visit the AMA portal to view the answer.";
                    
                    window.open(`mailto:${employeeEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');
                });
            }

            // Set up event listeners
            function setupEventListeners() {
                // Tab navigation
                document.getElementById('tabAllQuestions').addEventListener('click', () => showTab('tabAllQuestions'));
                document.getElementById('tabLeadershipUpdates').addEventListener('click', () => showTab('tabLeadershipUpdates'));
                document.getElementById('tabSubmitQuestion').addEventListener('click', () => showTab('tabSubmitQuestion'));
                document.getElementById('tabAdminPanel')?.addEventListener('click', () => showTab('tabAdminPanel'));
                
                // Form submissions
                document.getElementById('questionForm').addEventListener('submit', submitQuestion);
                document.getElementById('responseForm').addEventListener('submit', submitResponse);
                document.getElementById('updateForm').addEventListener('submit', submitUpdate);
                document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
                
                // Admin functions
                document.getElementById('adminLoginBtn').addEventListener('click', openAdminLoginModal);
                document.getElementById('adminLogoutBtn').addEventListener('click', handleAdminLogout);
                document.getElementById('cancelAdminLogin').addEventListener('click', closeAdminLoginModal);
                document.getElementById('cancelResponse').addEventListener('click', closeResponseModal);
                document.getElementById('addUpdateBtn').addEventListener('click', openUpdateModal);
                document.getElementById('cancelUpdate').addEventListener('click', closeUpdateModal);
                document.getElementById('cancelDelete').addEventListener('click', closeDeleteModal);
                document.getElementById('confirmDelete').addEventListener('click', deleteQuestion);
                document.getElementById('cancelDeleteUpdate').addEventListener('click', closeDeleteUpdateModal);
                document.getElementById('confirmDeleteUpdate').addEventListener('click', deleteUpdate);
                document.getElementById('saveAdminPassword').addEventListener('click', updateAdminPassword);
                
                // Email system
                document.getElementById('testEmailBtn').addEventListener('click', testEmailSystem);
                document.getElementById('viewEmailPreviewBtn').addEventListener('click', openEmailPreviewModal);
                document.getElementById('closeEmailPreview').addEventListener('click', closeEmailPreviewModal);
                
                // Setup manual email links
                setupManualEmailLinks();
                
                // Refresh functionality
                document.getElementById('manualRefreshBtn').addEventListener('click', manualRefresh);
                document.getElementById('autoRefreshToggle').addEventListener('change', toggleAutoRefresh);
                
                // Search and filter
                document.getElementById('searchInput').addEventListener('input', displayQuestions);
                document.getElementById('topicFilter').addEventListener('change', displayQuestions);
                document.getElementById('sortFilter').addEventListener('change', displayQuestions);
                
                // Close modals when clicking outside
                window.addEventListener('click', (e) => {
                    if (e.target === adminLoginModal) {
                        closeAdminLoginModal();
                    }
                    if (e.target === responseModal) {
                        closeResponseModal();
                    }
                    if (e.target === updateModal) {
                        closeUpdateModal();
                    }
                    if (e.target === deleteModal) {
                        closeDeleteModal();
                    }
                    if (e.target === deleteUpdateModal) {
                        closeDeleteUpdateModal();
                    }
                    if (e.target === emailPreviewModal) {
                        closeEmailPreviewModal();
                    }
                });
            }

            // Show All Questions tab by default
            showTab('tabAllQuestions');
        </script>
    </div>
</body>
</html>
